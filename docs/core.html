---

title: covid

keywords: fastai
sidebar: home_sidebar

summary: "Utility methods to process the John Hopkins University Covid-19 dataset using [nbdev](http://nbdev.fast.ai/)."
description: "Utility methods to process the John Hopkins University Covid-19 dataset using [nbdev](http://nbdev.fast.ai/)."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module has a dependency on the following Python libraries which have been added to the <code>requirements</code> field in <code>settings.ini</code>:</p>
<ul>
<li><code>requests</code></li>
<li><code>pandas</code></li>
<li><code>matplotlib</code></li>
<li><code>seaborn</code></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains some defaults for <code>seaborn</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="setDefaults" class="doc_header"><code>setDefaults</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>setDefaults</code>(<strong><code>figsize</code></strong>=<em><code>(18, 9)</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains the names of the time series files published by John Hopkins University (JHU).  Note that the format of these names changed overnight on 24.03.20 without prior warning.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Graphing-current-counts">1. Graphing current counts<a class="anchor-link" href="#1.-Graphing-current-counts"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains a couple of utility functions for returning yesterday and today as strings:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following two utility functions are used to process a JHU csv file and turn it into a <code>pandas</code> dataframe.  Note that the dataset changed a couple of column names on 24.03.20.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="procDataframe" class="doc_header"><code>procDataframe</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>procDataframe</code>(<strong><code>csv</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Convert input csv data or file to a pandas dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="procUrl" class="doc_header"><code>procUrl</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L70" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>procUrl</code>(<strong><code>url</code></strong>:<code>str</code>, <strong><code>download</code></strong>:<code>bool</code>, <strong><code>localfile</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>force</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>verbose</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Optionally download then process csv data or file at url converting it to a pandas dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains a utility method to return a <code>pandas</code> dataframe with a given day's daily report and then ploty it by <code>kind</code> which can be one of <code>["Confirmed","Deaths","Recovered"]</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getCountriesDailyReport" class="doc_header"><code>getCountriesDailyReport</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L85" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getCountriesDailyReport</code>(<strong><code>day</code></strong>:<code>str</code>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>force</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plotCountriesDailyReport" class="doc_header"><code>plotCountriesDailyReport</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L91" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plotCountriesDailyReport</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>which</code></strong>:<code>str</code>, <strong><code>topN</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>color</code></strong>:<code>str</code>=<em><code>'y'</code></em>, <strong><code>kind</code></strong>:<code>str</code>=<em><code>'Confirmed'</code></em>, <strong><code>visualisation</code></strong>:<code>str</code>=<em><code>'matplotlib'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plotCountryDailyReport" class="doc_header"><code>plotCountryDailyReport</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plotCountryDailyReport</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>country</code></strong>:<code>str</code>, <strong><code>which</code></strong>:<code>str</code>, <strong><code>topN</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>color</code></strong>:<code>str</code>=<em><code>'orange'</code></em>, <strong><code>kind</code></strong>:<code>str</code>=<em><code>'Confirmed'</code></em>, <strong><code>visualisation</code></strong>:<code>str</code>=<em><code>'matplotlib'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Graphing-time-series-counts">2. Graphing time series counts<a class="anchor-link" href="#2.-Graphing-time-series-counts"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains three utility methods to return time series data for each of <code>["Confirmed","Deaths","Recovered"]</code> in a <code>pandas</code> dataframe given a url to a corresponding csv file:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getTimeSeriesConfirmed" class="doc_header"><code>getTimeSeriesConfirmed</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getTimeSeriesConfirmed</code>(<strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>force</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getTimeSeriesDeaths" class="doc_header"><code>getTimeSeriesDeaths</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L159" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getTimeSeriesDeaths</code>(<strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>force</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getTimeSeriesRecovered" class="doc_header"><code>getTimeSeriesRecovered</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getTimeSeriesRecovered</code>(<strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>force</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains methods to aggregate each of <code>["Confirmed","Deaths","Recovered"]</code> by county.  Note that <code>force</code> and <code>download</code> are both set <code>True</code> in all cases.  Note also that at time of writing <code>Recovered</code> isn't supported as a time series dataset in a csv file.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="procTimeSeriesDataframe" class="doc_header"><code>procTimeSeriesDataframe</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L170" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>procTimeSeriesDataframe</code>(<strong><code>r</code></strong>:<code>List</code>[<code>T</code>])</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="procTimeSeries" class="doc_header"><code>procTimeSeries</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L176" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>procTimeSeries</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>kind</code></strong>:<code>str</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains a utility plotting method for the processed and aggregated time series dataframe:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plotCountriesTimeSeries" class="doc_header"><code>plotCountriesTimeSeries</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plotCountriesTimeSeries</code>(<strong><code>df</code></strong>:<code>DataFrame</code>, <strong><code>countries</code></strong>:<code>List</code>[<code>T</code>], <strong><code>which</code></strong>:<code>str</code>, <strong><code>kind</code></strong>:<code>str</code>, <strong><code>visualisation</code></strong>=<em><code>'matplotlib'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Graphing-counts-and-time-series-via-Covid-API">3. Graphing counts and time series via Covid API<a class="anchor-link" href="#3.-Graphing-counts-and-time-series-via-Covid-API"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following cell contains a utility method for plotting a sorted stacked bar graph of country data.  For the <code>altair</code> version of the stacked bar graph in <code>plotCountriesDailyReportFromAPI()</code>, this requires that we EITHER use <code>df.melt()</code> support to convert a wide format dataframe to a long format one OR we use <code>altair</code> <code>transform_fold()</code> support to manage that conversion for us.</p>

<pre><code>pandas.melt(frame: pandas.core.frame.DataFrame, id_vars=None, value_vars=None, var_name=None, value_name='value', col_level=None) → pandas.core.frame.DataFrame</code></pre>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getCountriesDailyReportFromAPI" class="doc_header"><code>getCountriesDailyReportFromAPI</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L223" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getCountriesDailyReportFromAPI</code>(<strong><code>normalised</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plotCountriesDailyReportFromAPI" class="doc_header"><code>plotCountriesDailyReportFromAPI</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L236" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plotCountriesDailyReportFromAPI</code>(<strong><code>normalised</code></strong>=<em><code>False</code></em>, <strong><code>visualisation</code></strong>=<em><code>'matplotlib'</code></em>, <strong><code>cutoff</code></strong>=<em><code>10</code></em>, <strong><code>transformFold</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getCategoryByCountryFromAPI" class="doc_header"><code>getCategoryByCountryFromAPI</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L270" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getCategoryByCountryFromAPI</code>(<strong><code>category</code></strong>:<code>str</code>, <strong><code>country</code></strong>:<code>str</code>, <strong><code>color</code></strong>:<code>str</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plotCategoryByCountryFromAPI" class="doc_header"><code>plotCategoryByCountryFromAPI</code><a href="https://github.com/malminhas/covid/tree/master/covid/core.py#L276" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plotCategoryByCountryFromAPI</code>(<strong><code>category</code></strong>:<code>str</code>, <strong><code>country</code></strong>:<code>str</code>, <strong><code>color</code></strong>:<code>str</code>=<em><code>'orange'</code></em>, <strong><code>visualisation</code></strong>:<code>str</code>=<em><code>'matplotlib'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="4.-Testing">4. Testing<a class="anchor-link" href="#4.-Testing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From <a href="http://nbdev.fast.ai/test/">the nbdev documentation</a>:</p>
<blockquote><p>Everything that is not an exported cell is considered a test, so you should make sure your notebooks can all run smoothly (and fast) if you want to use this functionality as the CLI.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_core.ipynb.
This cell doesn&#39;t have an export destination and was ignored:
e
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script>

